---
import Close from "@icons/Close.astro"
import GithubIcon from "@icons/GithubIcon.astro"
import LinkedIn from "@icons/LinkedIn.astro"
import Mail from "@icons/Mail.astro"
import Menu from "@icons/Menu.astro"
---

<header
  id="navbar"
  class="w-[95%] sm:w-full sticky top-5 left-0 z-50 px-0 sm:max-w-[920px] mx-auto bg-[#151519] sm:bg-[#15151990] border border-gray-700 backdrop-blur-3xl transition-all duration-300 rounded-md overflow-hidden"
>
  <nav class="flex flex-col sm:flex-row items-center mx-auto p-2">
    <div class="sm:hidden flex justify-between items-center w-full sm:w-auto">
      <!-- Logo -->
      <a
        href="/"
        class="logo-font text-lg font-medium text-gray-400 hover:text-white transition-colors duration-300 pl-2"
      >
        oussamaati.dev
      </a>

      <!-- Mobile Menu Button -->
      <button
        id="menu-button"
        class="p-2 text-white hover:bg-gray-800 rounded-md transition-colors duration-300"
      >
        <Menu class="open-menu size-6" />
        <Close class="close-menu size-6 hidden" />
      </button>
    </div>

    <!-- Main Navigation and Social Links -->
    <div
      id="nav-content"
      class="hidden flex-col items-center w-full mt-4 sm:mt-0 sm:flex sm:flex-row sm:justify-between"
    >
      <!-- Logo -->
      <a
        href="/"
        class="logo-font hidden sm:block font-medium text-gray-400 hover:text-white transition-colors duration-300 pl-2"
      >
        oussamaati.dev
      </a>
      <div class="flex flex-col sm:flex-row gap-2 items-center">
        <a
          href="#about"
          class="p-2 text-sm text-white w-full hover:bg-gray-800 bg-gray-800 sm:bg-transparent rounded-md transition-colors duration-300"
          >About</a
        >
        <a
          href="#experience"
          class="p-2 text-sm dark:text-white text-black w-full hover:bg-gray-800 bg-gray-800 sm:bg-transparent rounded-md transition-colors duration-300"
          >Experience</a
        >
        <a
          href="#projects"
          class="p-2 text-sm text-white w-full hover:bg-gray-800 bg-gray-800 sm:bg-transparent rounded-md transition-colors duration-300"
          >Projects</a
        >
        <a
          href="#certifications"
          class="p-2 text-sm text-white w-full hover:bg-gray-800 bg-gray-800 sm:bg-transparent rounded-md transition-colors duration-300"
          >Certifications</a
        >
        <a
          href="#skills"
          class="p-2 text-sm text-white w-full hover:bg-gray-800 bg-gray-800 sm:bg-transparent rounded-md transition-colors duration-300"
          >Skills</a
        >
      </div>

      <div class="flex gap-1 items-center mt-4 sm:mt-0">
        <a
          href="mailto:oussamaati03@gmail.com"
          aria-label="Email"
          class="p-2 text-white hover:bg-gray-800 rounded-md transition-colors duration-300"
        >
          <Mail class="size-5" />
        </a>
        <a
          href="https://github.com/OussamaAtifii"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="GitHub Profile"
          class="p-2 text-white hover:bg-gray-800 rounded-md transition-colors duration-300"
        >
          <GithubIcon class="size-[18px]" />
        </a>
        <a
          href="https://www.linkedin.com/in/oussama-atifi/"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="LinkedIn Profile"
          class="p-2 text-white hover:bg-gray-800 rounded-md transition-colors duration-300"
        >
          <LinkedIn class="size-[18px]" />
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  const menuButton = document.getElementById("menu-button")
  const navContent = document.getElementById("nav-content")

  const openMenu = document.querySelector(".open-menu")
  const closeMenu = document.querySelector(".close-menu")

  if (menuButton) {
    menuButton.addEventListener("click", () => {
      // Change menu visibility
      navContent?.classList.toggle("hidden")
      document.body.classList.toggle("overflow-hidden")

      // Change menu button icon
      openMenu?.classList.toggle("hidden")
      closeMenu?.classList.toggle("hidden")
    })
  }

  const links = navContent?.querySelectorAll("a")
  const header = document.querySelector("header")
  let linkClicked = false

  // Close the menu when clicking on a link
  if (links) {
    links?.forEach((link) => {
      link.addEventListener("click", () => {
        linkClicked = true
        header?.classList.add("hidden")

        setTimeout(() => {
          navContent?.classList.add("hidden")
          document.body.classList.remove("overflow-hidden")

          if (menuButton) {
            openMenu?.classList.remove("hidden")
            closeMenu?.classList.add("hidden")
          }
        }, 100)
      })
    })
  }

  // Hide the header when a link is clicked
  document.addEventListener("scroll", () => {
    if (linkClicked) {
      header?.classList.add("hidden")

      setTimeout(() => {
        linkClicked = false
      }, 1000)

      return
    }

    header?.classList.remove("hidden")
  })
</script>
